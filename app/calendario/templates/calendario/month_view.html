{% extends 'base.html' %}

{% block content %}
<h1>{{ month.strftime('%Y-%m') }}</h1>
<div>
    {% if nav_prev_month %}
        <a href="{{ url_for('calendario.index', month=nav_prev_month.strftime('%Y-%m')) }}">&lt;</a>
    {% else %}
        <span>&lt;</span>
    {% endif %}
    {% if nav_next_month %}
        <a href="{{ url_for('calendario.index', month=nav_next_month.strftime('%Y-%m')) }}">&gt;</a>
    {% else %}
        <span>&gt;</span>
    {% endif %}
    <a href="{{ url_for('calendario.index', view='week', week=(month - timedelta(days=month.weekday())).isoformat()) }}">週表示</a>
</div>
<table class="calendar">
<thead>
<tr>
    <th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th><th>Sun</th>
</tr>
</thead>
<tbody>
{% for week in weeks %}
<tr>
    {% for d in week %}
    <td class="{% if d.month != month.month %}other-month{% endif %}">
        {{ d.day }}
        <ul>
        {% for ev in events_by_date.get(d.isoformat(), []) %}
            <li>
                {{ ev.title }}
                <a href="{{ url_for('calendario.edit_event', event_id=ev.id) }}" class="edit-link" style="font-size: 0.8em; margin-left: 5px;">編集</a>
            </li>
        {% endfor %}
        </ul>
    </td>
    {% endfor %}
</tr>
{% endfor %}
</tbody>
</table>
<p><a href="{{ url_for('calendario.add') }}">予定を追加</a></p>
{% if user.role == 'admin' %}
<p><a href="{{ url_for('calendario.shift') }}">シフト管理エリア</a></p>
{% endif %}
<p><a href="{{ url_for('index') }}">戻る</a></p>
{% endblock %}
